@tailwind base;
@tailwind components;
@tailwind utilities;

/* Mozilla Text only (no Inter) */
@import url("https://fonts.googleapis.com/css2?family=Mozilla+Text:wght@400;500;600;700&display=swap");

/* Base */
:root { color-scheme: light; }
html, body { height: 100%; }
body { @apply bg-white text-slate-900; }
.container { @apply mx-auto max-w-[1100px] px-4; }
@supports (-webkit-touch-callout: none) { body { min-height: -webkit-fill-available; } }
/* Prevent simple print */
@media print { body { display: none !important; } }

/* =======================================
   THEME TOKENS (Light / Dark)
======================================= */
@layer base {
  :root {
    --font-mozilla: "Mozilla Text", ui-sans-serif, system-ui, -apple-system, "Segoe UI",
                    Roboto, "Helvetica Neue", Arial, "Noto Sans";

    --background: 0 0% 100%;
    --foreground: 222 47% 11%;

    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;

    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;

    /* Brand primary (violet) */
    --primary: 242 90% 66%;
    --primary-foreground: 0 0% 100%;

    --secondary: 220 16% 96%;
    --secondary-foreground: 222 47% 11%;

    --muted: 220 16% 96%;
    --muted-foreground: 220 10% 46%;

    --accent: 220 16% 96%;
    --accent-foreground: 222 47% 11%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;

    --border: 220 14% 90%;
    --input: 220 14% 90%;
    --ring: 258 90% 66%;

    --chart-1: 258 90% 66%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;

    --radius: 0.75rem;
  }

  .dark {
    --background: 222 47% 7%;
    --foreground: 215 20% 92%;

    --card: 222 47% 8%;
    --card-foreground: 215 20% 92%;

    --popover: 222 47% 8%;
    --popover-foreground: 215 20% 92%;

    --primary: 258 90% 72%;
    --primary-foreground: 0 0% 100%;

    --secondary: 222 28% 12%;
    --secondary-foreground: 215 20% 92%;

    --muted: 222 28% 12%;
    --muted-foreground: 215 15% 70%;

    --accent: 222 28% 12%;
    --accent-foreground: 215 20% 92%;

    --destructive: 0 65% 45%;
    --destructive-foreground: 0 0% 100%;

    --border: 222 28% 18%;
    --input: 222 28% 18%;
    --ring: 258 90% 72%;

    --chart-1: 258 90% 72%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
  }
}

@layer base {
  * { @apply border-border; }
  body {
    font-family: var(--font-mozilla);
    @apply bg-background text-foreground leading-[1.6];
  }

  html {
    font-feature-settings: "cv02","cv03","cv04","ss01","ss02","ss03";
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Headings also Mozilla Text */
  h1,h2,h3,h4,h5,h6 { font-family: var(--font-mozilla); @apply tracking-tight text-slate-900 dark:text-slate-100; }
  h1{ @apply text-4xl md:text-5xl lg:text-6xl leading-[1.05]; font-weight:700 }
  h2{ @apply text-3xl md:text-4xl leading-tight; }
  h3{ @apply text-2xl md:text-3xl leading-snug; }
  p { @apply text-[1.05rem] text-slate-700 dark:text-slate-300; }
  small, .text-xs { @apply text-slate-500; }
}

/* =======================================
   COMPONENT UTILITIES
======================================= */
@layer components {
  .glass {
    @apply bg-white/70 backdrop-blur supports-[backdrop-filter]:bg-white/60 border border-slate-200/70
           dark:bg-slate-900/40 dark:border-slate-800/70;
  }

  .card-soft {
    @apply rounded-2xl border border-slate-200/70 bg-gradient-to-br from-white to-slate-50 shadow-sm
           dark:border-slate-800/70 dark:from-slate-900 dark:to-slate-900/60;
  }

  .btn-outline-strong:hover {
    background: rgba(255,255,255,0.06);
    border-color: rgba(148,163,184,.6);
  }

  .divider-line { @apply h-px w-full bg-gradient-to-r from-primary/40 to-transparent; }

  .focus-soft { @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/60; }
}

/* =======================================
   EFFECT HELPERS
======================================= */
@layer utilities {
  .bg-grain {
    background-image: url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'>\
<filter id='n'><feTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/>\
<feColorMatrix type='saturate' values='0'/>\
<feComponentTransfer><feFuncA type='linear' slope='0.45'/></feComponentTransfer></filter>\
<rect width='100%' height='100%' filter='url(%23n)'/>\
</svg>");
    background-size: 256px 256px;
    @apply mix-blend-overlay opacity-20 dark:opacity-15;
  }
  .aurora-blob { @apply blur-3xl rounded-full absolute; }
}

/* =======================================
   BOOK / PAGE-TURN EFFECTS (unchanged)
======================================= */
.book-draw {
  stroke-width: 3.2;
  animation: bookdraw 5s ease;
}

.page-stage { perspective: 1400px; }

.page-turn {
  position: relative;
  transform-style: preserve-3d;
  transform-origin: left center;
  transition: transform .9s cubic-bezier(.22,.61,.36,1), filter .9s ease;
  will-change: transform;
}

.page-turn.is-turning { animation: flip3d .85s cubic-bezier(.3,.7,.2,1) both; }

.page-turn::after {
  content: "";
  position: absolute; inset: 0; pointer-events: none; opacity: 0;
  transition: opacity .9s;
  background: linear-gradient(90deg, rgba(0,0,0,.18), rgba(0,0,0,0) 38%);
}
.page-turn.is-turning::after { opacity: .28; }

@keyframes flip3d {
  0%   { transform: rotateY(0deg) translateX(0) scale(1); }
  40%  { transform: rotateY(-12deg) translateX(-1.2%) scale(.993); }
  100% { transform: rotateY(0deg) translateX(0) scale(1); }
}

/* Reduced motion safety */
@media (prefers-reduced-motion: reduce) {
  .page-turn, .page-turn.is-turning { transition: none; animation: none; }
}
